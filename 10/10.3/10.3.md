# 10.3. Tablas Involucradas (Entradas, Temporales, Salidas)

# Módulo 2 - 'Equipos'

##  **Tablas de Entrada**
Estas tablas contienen los datos originales necesarios para procesar las operaciones en el sistema.
- **Cliente**: Información de los clientes (`COD_CLIENTE`, `NOMBRE`, `RAZON_SOCIAL`, etc.)
- **Equipo**: Detalles de los equipos disponibles (`COD_EQUIPO`, `NOMBRE_EQUIPO`, `MARCA`, `MODELO`, etc.)
- **Pedido**: Registra los pedidos realizados, incluyendo el estado y monto (`COD_PEDIDO`, `COD_CLIENTE`, `ESTADO_PEDIDO`, `MONTO_PEDIDO`, etc.)
- **Pedido_Equipo**: Relaciona los pedidos con los equipos solicitados (`COD_PEDIDO`, `COD_EQUIPO`, `CANTIDAD_PEDIDA`, `MONTO_EQUIPO`).

##  **Tablas Temporales**
Tablas o vistas intermedias que se usan para cálculos y transformaciones de datos.

- **Vista `detalles_pedido_equipo`**: Combina las tablas `Pedido`, `Pedido_Equipo` y `Equipo` para mostrar los detalles de los pedidos pendientes.

  ```sql
  CREATE VIEW detalles_pedido_equipo AS
  SELECT 
      p.cod_pedido,
      p.cod_cliente,
      p.fecha_reg_pedido,
      p.fecha_evaluacion,
      p.estado_pedido,
      p.metodo_pago,
      p.tipo_pedido,
      p.monto_pedido,
      pe.cod_equipo,
      e.nombre_equipo,
      e.marca,
      e.modelo,
      e.precio_unitario,
      pe.cantidad_pedida,
      pe.monto_equipo,
      p.observaciones
  FROM 
      pedido p
  JOIN 
      pedido_equipo pe ON p.cod_pedido = pe.cod_pedido
  JOIN 
      equipo e ON pe.cod_equipo = e.cod_equipo
  WHERE 
      p.estado_pedido = 'Pendiente';  





## **Tablas de Salida**
Estas tablas almacenan los resultados finales después de procesar los datos.

- **Pedido_Equipo**: Relaciona los pedidos con los equipos y sus cantidades. Se actualiza cuando se acepta un pedido y se ajusta el stock de los equipos.
- **Factura**: Contiene la información de las facturas generadas por los pedidos aceptados. Esta tabla está relacionada con el `COD_PEDIDO`.
- **Cliente**: Después de procesar el pedido, se actualiza la línea de crédito del cliente en la tabla `Cliente`, reflejando los cambios en su crédito disponible.


# Módulo 3 - Recargas

# **Tablas de Entrada**
Estas tablas contienen los datos originales necesarios para procesar las operaciones en el sistema.

**Cliente**: Contiene información básica de los clientes (COD_CLIENTE, NOMBRE, RAZON_SOCIAL, CREDITO_MAXIMO, etc.).

**Recarga:** Registra los datos de los pedidos de recarga realizados (COD_RECARGA, COD_CLIENTE, MONTO_RECARGA, ESTADO_RECARGA, etc.).

# **Tablas Temporales**
Tablas o vistas intermedias que se usan para cálculos y transformaciones de datos.

**Vista** evaluacion_recarga: Combina las tablas Recarga y Cliente para mostrar los pedidos de recarga pendientes con información del cliente y los detalles de la solicitud.


  ```sql
CREATE VIEW evaluacion_recarga AS
SELECT 
    r.cod_recarga,
    r.cod_cliente,
    c.nombre AS nombre_cliente,
    c.razon_social,
    r.monto_solicitado,
    r.fecha_solicitud,
    r.estado_recarga,
    c.credito_disponible,
    c.deuda_vencida
FROM 
    recarga r
JOIN 
    cliente c ON r.cod_cliente = c.cod_cliente
WHERE 
    r.estado_recarga = 'Pendiente'; 
    
```

**Resultado de la Vista**

cod_recarga: Identificador único de la recarga.
cod_cliente: Identificador único del cliente que solicita la recarga.
nombre_cliente: Nombre del cliente.
razon_social: Razón social del cliente.
monto_recarga: Monto solicitado en la recarga.
estado_recarga: Estado actual del pedido ("Pendiente").
linea_credito: Línea de crédito disponible del cliente.


# **Tablas de Salida**
Estas tablas almacenan los resultados finales después de procesar los datos.

**Recarga:** Se actualiza con el estado final del pedido (aprobado o rechazado) y, si es aprobado, con el monto facturado.

**Factura:** Contiene la información de las facturas generadas por los pedidos de recarga aceptados (COD_FACTURA, COD_RECARGA, MONTO_FACTURA, FECHA_FACTURA, etc.).

**Cliente:** Actualiza el crédito disponible del cliente tras la aprobación de un pedido de recarga.